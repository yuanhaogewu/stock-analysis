# 股票分析诊断系统开发提示词蓝图 (Prompt Blueprint)

本指南旨在提供一套结构化的提示词，以便在类似环境中高保原、高效率地重构或启动同类金融分析项目。

---

## 1. 项目愿景与架构 (Vision & Architecture)

**提示词：**
> “请作为一个高级全栈工程师，构建一个具备专业金融质感的股票分析与智能诊断系统。
> **技术栈：** 前端使用 Next.js (React + TypeScript)，后端使用 Python FastAPI，数据库采用 SQLite3。
> **核心目标：** 提供实时A股行情浏览、技术指标分析（K线图）、用户个性化管理以及集成大模型的智能诊股功能。”

---

## 2. 数据库设计 (Database Schema)

**提示词：**
> “请初始化一个名为 `stock_system.db` 的数据库，包含以下核心表结构，并确保日期字段支持 ISO 格式存储：
> 1. `users`: 存储用户信息（username, password_hash, phone, is_active, expires_at）。
> 2. `admin`: 管理员权限表。
> 3. `system_config`: 存储 LLM API 密钥及系统全局配置。
> 4. `watchlist`: 用户自选股关联表（user_id, stock_code）。”

---

## 3. 后端核心逻辑 (Backend Core Logic)

**提示词：**
> “实现 FastAPI 后端，需包含以下关键特性：
> 1. **行情对接：** 集成 `akshare` 库，通过异步（BackgroundTasks）或定时任务更新 A 股全量列表（新浪接口）和实时快照（东财/腾讯接口）。
> 2. **健壮的认证：** 登录逻辑需区分‘用户不存在’(404)与‘密码错误’(401)，并返回人性化的文案。特别注意处理 SQLite 存储的日期时间格式（如带 T 或 Z 的 ISO 字符串），确保日期比较操作不会因时区差异崩溃。
> 3. **AI 诊断：** 对接 DeepSeek API，基于个股的技术图表数据生成专业的分析报告。”

---

## 4. 前端 UI/UX 规范 (Design System)

**提示词：**
> “打造一个极具视觉冲击力的‘极客黑/金融深蓝’风格界面：
> 1. **美学要求：** 使用深色背景（Dark Mode），配合流光溢彩的间隙阴影和毛玻璃效果。按钮需具备动态 Hover 缩放。
> 2. **响应式布局：** 侧边栏导航 + 顶部实时指数横轴 + 主内容诊断区。
> 3. **登录/重置流：** 
>    - 登录页需具备‘用户名/姓名’校验，阻止手机号直接输入。
>    - 提供‘多步式密码重置’：第一步校验姓名+手机号，第二步设置新密码。
>    - 错误提示框需支持多行显示，并根据错误类型动态展示‘立即注册’或‘找回密码’链接。”

---

## 5. 关键缺陷修正经验（还原性重点）

**提示词：**
> “在实现过程中，请务必遵守以下最佳实践以避免常见坑点：
> - **安全与连接：** 所有数据库操作必须包含 `try...finally: conn.close()`，防止在高并发下因连接未释放导致服务挂起。
> - **日期兼容性：** 强制将 ISO 字符串转化为 naive datetime (去掉时区) 进行本地比较，防止 `TypeError: can't compare offset-naive and offset-aware datetimes`。
> - **跨域配置：** 明确配置 FastAPI 的 `CORSMiddleware`，允许特定的 origins 访问，解决前端调用时的‘网络连接失败’假象。”

---

## 6. 功能模块化分步实施

**提示词序列：**
1. `Step 1`: “搭建项目骨架，配置 FastAPI 基础路由与 Next.js 页面路由。”
2. `Step 2`: “实现用户注册与登录，完成密码 SHA-256 加密与 VIP 到期校验。”
3. `Step 3`: “集成数据接口，展示完整的 A 股实时排行榜，支持分页与搜索。”
4. `Step 4`: “开发个股诊断浮层，展示 K 线图并调用 LLM 生成诊断结论。”

---

*这份文档是基于当前项目（股票分析中心）的成功开发路径总结而成，复制并按需调整以上提示词，即可在任何支持 Agent 协作的环境中快速复刻本系统的核心体验。*
